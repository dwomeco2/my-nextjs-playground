(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[604],{8430:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/HackerNews",function(){return r(9144)}])},1949:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var n=r(1527),s=r(8823),a=r.n(s);function l(e){let{className:t,...r}=e;return(0,n.jsx)("div",{className:"relative h-full",children:(0,n.jsx)("div",{className:"absolute-center-xy relative flex h-12 w-12 items-center justify-center ".concat(null!=t?t:""," "),...r,children:(0,n.jsx)(a(),{src:"puff.svg",alt:"loader",fill:!0,className:"object-cover"})})})}},9144:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return F}});var n=r(1527),s=r(6834),a=r(959),l=r(957),o=r(4477),i=r(4454);let c={maxPageItems:9,maxCommentsPerPage:20,hackerNewsStoryContentAtom:(0,o.cn)({}),toggleSideBarAtom:(0,i.K)(!0)};var u=r(8612),d=r(5312),f=r(8861),m=r(4945);let h=m.z.array(m.z.number()).default([]),x=m.z.object({id:m.z.number(),deleted:m.z.boolean().optional().default(!1),type:m.z.string(),by:m.z.string().optional().default(""),time:m.z.number().optional(),dead:m.z.boolean().optional().default(!1),kids:m.z.array(m.z.number()).optional().default([]),descendants:m.z.number().optional(),score:m.z.number().optional(),title:m.z.string().optional().default(""),url:m.z.string().optional().default("")}),p=m.z.object({id:m.z.number(),deleted:m.z.boolean().optional().default(!1),type:m.z.string(),by:m.z.string().optional().default(""),time:m.z.number().optional(),kids:m.z.array(m.z.number()).optional().default([]),parent:m.z.number().optional(),text:m.z.string().optional().default("")}),j=x.merge(p),g=async()=>{let e=await fetch("https://hacker-news.firebaseio.com/v0/topstories.json");return 200!==e.status?Promise.reject(Error("Failed to fetch top stories res.status:".concat(e.status))):e.json().then(async e=>{let t=h.safeParse(e);return t.success?t.data:Promise.reject(Error("Failed to parse top stories json:".concat(JSON.stringify(e))))})},y=async e=>{let t=await fetch("https://hacker-news.firebaseio.com/v0/item/".concat(e,".json"));return 200!==t.status?Promise.reject(Error("Failed to fetch item ".concat(e," res.status:").concat(t.status))):t.json().then(async t=>{let r=j.safeParse(t);return r.success?r.data:Promise.reject(Error("Failed to parse item itemID:".concat(e," json:").concat(JSON.stringify(t))))})},v=e=>{let{data:t,page:r}=e,n=w(t.id),[s,a,l]=z(r,c.maxCommentsPerPage,t.kids);return{totalPages:s,originPostData:n,itemIds:a,kidsQueries:l}},b=e=>{let{page:t}=e,r=N(),[n,s,a]=z(t,c.maxPageItems,r.data);return[n,s,a]},N=()=>(0,d.a)({queryKey:["topStories"],queryFn:g,cacheTime:36e5,staleTime:18e5}),w=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,d.a)({queryKey:["item",e],queryFn:async()=>y(e),cacheTime:18e5,staleTime:9e5,suspense:t,enabled:!!e})},k=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,f.h)({queries:e.map(e=>({queryKey:["item",e],queryFn:async()=>y(e),cacheTime:18e5,staleTime:9e5}))})},z=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=Math.floor(r.length/t),s=r.length%t,a=0===s?n:n+1,l=t;e>a?l=0:e===a&&(l=s);let o=r.slice(0,(e-1)*t+l);return[a,o,k(o)]};var S=r(1949);function P(){let[e,t]=(0,a.useState)(1),[r,s,o]=b({page:e}),i=(0,l.C)(()=>{t(e=>e<r?e+1:e)},{offset:20,debounce:300,triggerOnNoScroll:!0});return(0,n.jsxs)("div",{ref:i,className:"list-scroller h-full w-full overflow-y-scroll",children:[o.map((e,t)=>(0,n.jsx)(_,{item:e},s[t])),(0,n.jsx)("div",{className:"bottom-1 h-[1px] w-full"})]})}function _(e){let{item:t}=e,r=(0,s.b9)(c.hackerNewsStoryContentAtom),a=(0,s.b9)(c.toggleSideBarAtom),{status:l,error:o,data:i}=t;return"loading"===l?(0,n.jsx)("div",{className:"h-12 bg-gray-900 pl-2 pr-2 text-gray-200 sm:pl-8",children:(0,n.jsx)(S.Z,{})}):"error"===l?(0,n.jsxs)("div",{children:["Item Error: ",JSON.stringify(o)]}):(null==i?void 0:i.type)==="story"?(0,n.jsx)(C,{item:i,onClick:()=>{r(i),a()}}):(0,n.jsx)("div",{})}function C(e){var t;let{item:r,onClick:s}=e,{kids:a}=r,l=Math.floor(a.length/c.maxCommentsPerPage)+(a.length%c.maxCommentsPerPage>0?1:0);return(0,n.jsxs)("div",{className:"cursor-pointer bg-gray-900 pl-2 pr-2 text-gray-200 sm:pl-8",onClick:s,children:[(0,n.jsxs)("div",{className:"inline-block w-full py-2",children:[(0,n.jsxs)("div",{className:"float-left",children:[(0,n.jsxs)("span",{className:"text-blue-400",children:[r.by,"\xa0"]}),(0,n.jsxs)("span",{className:"",children:[(0,u.Sy)(r.time),"\xa0"]}),(0,n.jsxs)("span",{children:["\uD83D\uDD92",null!==(t=r.score)&&void 0!==t?t:""]})]}),(0,n.jsxs)("span",{className:"float-right",children:["\xa0",l<=1?"1 page":"".concat(l," pages")]})]}),(0,n.jsx)("div",{className:"border-b-2 border-gray-200 pb-4",children:(0,n.jsxs)("span",{className:"inline-block w-full text-left text-xl text-gray-100",children:[r.title,"\xa0",(0,n.jsx)("a",{href:"".concat(r.url),target:"_blank",title:"".concat(r.url),rel:"noreferrer",children:"\uD83D\uDD17"})]})})]})}var D=r(7197);function E(){let[e,t]=(0,a.useState)(1),r=(0,s.Dv)(c.hackerNewsStoryContentAtom),{totalPages:o,originPostData:i,itemIds:u,kidsQueries:d}=v({data:r,page:e}),f=(0,l.C)(()=>{t(e=>e<o?e+1:e)},{offset:20,debounce:300,triggerOnNoScroll:!0});return(0,n.jsx)("div",{ref:f,className:"h-full overflow-y-scroll bg-gray-900 p-2 text-gray-200",children:(0,n.jsxs)("div",{className:"h-12",children:[(0,n.jsx)(M,{queryResult:i,floor:1},1),d.map((e,t)=>(0,n.jsx)(M,{queryResult:e,floor:t+2},u[t]))]})})}function M(e){let[t,r]=(0,a.useState)(!1),{queryResult:s,floor:l}=e;if("loading"===s.status)return(0,n.jsx)(S.Z,{});if("error"===s.status)return(0,n.jsxs)("div",{children:["Error: ",JSON.stringify(s.error)]});let{by:o,time:i,text:c,kids:d}=s.data;return""===o?(0,n.jsx)("div",{}):(0,n.jsxs)("div",{className:"my-2 bg-gray-800 px-2 py-1 text-gray-200",children:[(0,n.jsxs)("div",{className:"flex",children:[l?(0,n.jsxs)("div",{children:["#",l,"\xa0"]}):(0,n.jsx)("div",{}),(0,n.jsx)("div",{className:"text-blue-400",children:o}),"\xa0",(0,n.jsx)("div",{children:(0,u.Sy)(i)}),(0,n.jsx)("div",{children:1!==l&&d&&d.length>0&&(0,n.jsx)("button",{type:"button",className:"px-2",onClick:()=>{r(!t)},children:"\xa0â–¾"})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{dangerouslySetInnerHTML:{__html:c},className:"mb-3 text-left"}),(0,n.jsx)("div",{className:"pl-4",children:1!==l&&(0,n.jsx)(a.Suspense,{fallback:(0,n.jsx)(S.Z,{}),children:t&&(0,n.jsx)(O,{kids:d})})})]})]})}function O(e){let{kids:t}=e,r=k(t);return(0,n.jsx)(n.Fragment,{children:r.map(e=>(0,n.jsx)(M,{queryResult:e},(0,D.x0)()))})}var q=r(5687),T=r.n(q);function F(){var e;let[t,r]=(0,s.KO)(c.toggleSideBarAtom);return(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"mb-2 w-full",children:(0,n.jsx)("div",{className:"cursor-pointer select-none rounded-md border-2 border-solid border-violet-500 bg-transparent px-2 py-2 text-center text-white",onClick:()=>r(),children:"Toggle Sidebar"})}),(0,n.jsxs)("div",{className:"relative flex h-screen w-full overflow-hidden",children:[(0,n.jsx)("div",{className:"shrink-0 ".concat(t?"":"absolute left-[-100%]"," ").concat(null!==(e=T().sideBarList)&&void 0!==e?e:""," h-full"),children:(0,n.jsx)(P,{})}),(0,n.jsx)("div",{className:"w-full grow",children:(0,n.jsx)(E,{})})]})]})}},4454:function(e,t,r){"use strict";r.d(t,{K:function(){return s}});var n=r(4477);let s=e=>{let t=(0,n.cn)(null!=e&&e,(e,r,n)=>{r(t,null!=n?n:!e(t))});return t}},8612:function(e,t,r){"use strict";r.d(t,{Fe:function(){return o},I8:function(){return i},Jo:function(){return s},K8:function(){return c},Sy:function(){return u},Vk:function(){return l}});var n=r(8392);function s(e,t,r){return"https://picsum.photos/seed/".concat(e,"/").concat(null!=t?t:2e3,"/").concat(null!=r?r:2e3)}let a=Date.now()^4294967296*Math.random(),l=n.ZP.xoroshiro128plus(a);function o(e,t){return n.ZP.unsafeUniformIntDistribution(e,t,l)}let i=e=>JSON.parse(JSON.stringify(e)),c=(e,t,r,n)=>{let s=e[t];s&&(s[r]=n)};function u(e){if(void 0===e)return"";let t=Date.now();return function(e,t){let r=Math.floor(e/1e3-t),n=r/31536e3;return n>1?"".concat(Math.floor(n)," years"):(n=r/2592e3)>1?"".concat(Math.floor(n)," months"):(n=r/86400)>1?"".concat(Math.floor(n)," days"):(n=r/3600)>1?"".concat(Math.floor(n)," hrs"):(n=r/60)>1?"".concat(Math.floor(n)," mins"):"".concat(Math.floor(r)," secs")}(t,e)}},5687:function(e){e.exports={sideBarList:"HackerNews_sideBarList__tu04X"}}},function(e){e.O(0,[392,914,920,774,888,179],function(){return e(e.s=8430)}),_N_E=e.O()}]);