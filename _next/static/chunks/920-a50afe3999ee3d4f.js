(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[920],{6763:function(e,t,r){var s=0/0,n=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,o=/^0o[0-7]+$/i,l=parseInt,a="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,c="object"==typeof self&&self&&self.Object===Object&&self,h=a||c||Function("return this")(),d=Object.prototype.toString,f=Math.max,p=Math.min,v=function(){return h.Date.now()};function b(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function y(e){if("number"==typeof e)return e;if("symbol"==typeof(t=e)||t&&"object"==typeof t&&"[object Symbol]"==d.call(t))return s;if(b(e)){var t,r="function"==typeof e.valueOf?e.valueOf():e;e=b(r)?r+"":r}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(n,"");var a=u.test(e);return a||o.test(e)?l(e.slice(2),a?2:8):i.test(e)?s:+e}e.exports=function(e,t,r){var s,n,i,u,o,l,a=0,c=!1,h=!1,d=!0;if("function"!=typeof e)throw TypeError("Expected a function");function m(t){var r=s,i=n;return s=n=void 0,a=t,u=e.apply(i,r)}function g(e){var r=e-l,s=e-a;return void 0===l||r>=t||r<0||h&&s>=i}function R(){var e,r,s,n=v();if(g(n))return E(n);o=setTimeout(R,(e=n-l,r=n-a,s=t-e,h?p(s,i-r):s))}function E(e){return(o=void 0,d&&s)?m(e):(s=n=void 0,u)}function S(){var e,r=v(),i=g(r);if(s=arguments,n=this,l=r,i){if(void 0===o)return a=e=l,o=setTimeout(R,t),c?m(e):u;if(h)return o=setTimeout(R,t),m(l)}return void 0===o&&(o=setTimeout(R,t)),u}return t=y(t)||0,b(r)&&(c=!!r.leading,i=(h="maxWait"in r)?f(y(r.maxWait)||0,t):i,d="trailing"in r?!!r.trailing:d),S.cancel=function(){void 0!==o&&clearTimeout(o),a=0,s=l=n=o=void 0},S.flush=function(){return void 0===o?u:E(v())},S}},957:function(e,t,r){"use strict";r.d(t,{C:function(){return u}});var s=r(959),n=r(6763),i=r.n(n);function u(e,t){var r=(0,s.useMemo)(function(){var e,r,s,n;return{offset:null!=(e=null==t?void 0:t.offset)?e:0,debounce:null!=(r=null==t?void 0:t.debounce)?r:200,debounceOptions:null!=(s=null==t?void 0:t.debounceOptions)?s:{leading:!0},triggerOnNoScroll:null!=(n=null==t?void 0:t.triggerOnNoScroll)&&n}},[null==t?void 0:t.offset,null==t?void 0:t.debounce,null==t?void 0:t.debounceOptions,null==t?void 0:t.triggerOnNoScroll]),n=r.offset,u=r.triggerOnNoScroll,o=r.debounce,l=r.debounceOptions,a=(0,s.useMemo)(function(){return o?i()(e,o,l):e},[o,e]),c=(0,s.useRef)(null),h=(0,s.useCallback)(function(){if(null!=c.current){var e=c.current,t=Math.round(e.scrollTop+e.clientHeight);Math.round(e.scrollHeight-n)<=t&&a()}else{var r=document.scrollingElement||document.documentElement,s=Math.round(r.scrollTop+window.innerHeight);Math.round(r.scrollHeight-n)<=s&&a()}},[n,e,c.current]);return(0,s.useEffect)(function(){var e=c.current;return null!=e?e.addEventListener("scroll",h):window.addEventListener("scroll",h),u&&h(),function(){null!=e?e.removeEventListener("scroll",h):window.removeEventListener("scroll",h)}},[h,o]),c}},2415:function(e,t,r){"use strict";/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s=r(959),n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=s.useState,u=s.useEffect,o=s.useLayoutEffect,l=s.useDebugValue;function a(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!n(e,r)}catch(e){return!0}}var c="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var r=t(),s=i({inst:{value:r,getSnapshot:t}}),n=s[0].inst,c=s[1];return o(function(){n.value=r,n.getSnapshot=t,a(n)&&c({inst:n})},[e,r,t]),u(function(){return a(n)&&c({inst:n}),e(function(){a(n)&&c({inst:n})})},[e]),l(r),r};t.useSyncExternalStore=void 0!==s.useSyncExternalStore?s.useSyncExternalStore:c},4322:function(e,t,r){"use strict";e.exports=r(2415)},9168:function(e,t,r){"use strict";r.d(t,{z:function(){return l}});var s=r(2043),n=r(8650),i=r(1089),u=r(1453),o=r(4754);class l extends u.l{constructor(e,t){super(),this.client=e,this.options=t,this.trackedProps=new Set,this.selectError=null,this.bindMethods(),this.setOptions(t)}bindMethods(){this.remove=this.remove.bind(this),this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.length&&(this.currentQuery.addObserver(this),a(this.currentQuery,this.options)&&this.executeFetch(),this.updateTimers())}onUnsubscribe(){this.listeners.length||this.destroy()}shouldFetchOnReconnect(){return c(this.currentQuery,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return c(this.currentQuery,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=[],this.clearStaleTimeout(),this.clearRefetchInterval(),this.currentQuery.removeObserver(this)}setOptions(e,t){let r=this.options,n=this.currentQuery;if(this.options=this.client.defaultQueryOptions(e),(0,s.VS)(r,this.options)||this.client.getQueryCache().notify({type:"observerOptionsUpdated",query:this.currentQuery,observer:this}),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled)throw Error("Expected enabled to be a boolean");this.options.queryKey||(this.options.queryKey=r.queryKey),this.updateQuery();let i=this.hasListeners();i&&h(this.currentQuery,n,this.options,r)&&this.executeFetch(),this.updateResult(t),i&&(this.currentQuery!==n||this.options.enabled!==r.enabled||this.options.staleTime!==r.staleTime)&&this.updateStaleTimeout();let u=this.computeRefetchInterval();i&&(this.currentQuery!==n||this.options.enabled!==r.enabled||u!==this.currentRefetchInterval)&&this.updateRefetchInterval(u)}getOptimisticResult(e){let t=this.client.getQueryCache().build(this.client,e);return this.createResult(t,e)}getCurrentResult(){return this.currentResult}trackResult(e){let t={};return Object.keys(e).forEach(r=>{Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:()=>(this.trackedProps.add(r),e[r])})}),t}getCurrentQuery(){return this.currentQuery}remove(){this.client.getQueryCache().remove(this.currentQuery)}refetch({refetchPage:e,...t}={}){return this.fetch({...t,meta:{refetchPage:e}})}fetchOptimistic(e){let t=this.client.defaultQueryOptions(e),r=this.client.getQueryCache().build(this.client,t);return r.isFetchingOptimistic=!0,r.fetch().then(()=>this.createResult(r,t))}fetch(e){var t;return this.executeFetch({...e,cancelRefetch:null==(t=e.cancelRefetch)||t}).then(()=>(this.updateResult(),this.currentResult))}executeFetch(e){this.updateQuery();let t=this.currentQuery.fetch(this.options,e);return null!=e&&e.throwOnError||(t=t.catch(s.ZT)),t}updateStaleTimeout(){if(this.clearStaleTimeout(),s.sk||this.currentResult.isStale||!(0,s.PN)(this.options.staleTime))return;let e=(0,s.Kp)(this.currentResult.dataUpdatedAt,this.options.staleTime);this.staleTimeoutId=setTimeout(()=>{this.currentResult.isStale||this.updateResult()},e+1)}computeRefetchInterval(){var e;return"function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.currentResult.data,this.currentQuery):null!=(e=this.options.refetchInterval)&&e}updateRefetchInterval(e){this.clearRefetchInterval(),this.currentRefetchInterval=e,!s.sk&&!1!==this.options.enabled&&(0,s.PN)(this.currentRefetchInterval)&&0!==this.currentRefetchInterval&&(this.refetchIntervalId=setInterval(()=>{(this.options.refetchIntervalInBackground||i.j.isFocused())&&this.executeFetch()},this.currentRefetchInterval))}updateTimers(){this.updateStaleTimeout(),this.updateRefetchInterval(this.computeRefetchInterval())}clearStaleTimeout(){this.staleTimeoutId&&(clearTimeout(this.staleTimeoutId),this.staleTimeoutId=void 0)}clearRefetchInterval(){this.refetchIntervalId&&(clearInterval(this.refetchIntervalId),this.refetchIntervalId=void 0)}createResult(e,t){let r;let n=this.currentQuery,i=this.options,u=this.currentResult,l=this.currentResultState,c=this.currentResultOptions,f=e!==n,p=f?e.state:this.currentQueryInitialState,v=f?this.currentResult:this.previousQueryResult,{state:b}=e,{dataUpdatedAt:y,error:m,errorUpdatedAt:g,fetchStatus:R,status:E}=b,S=!1,O=!1;if(t._optimisticResults){let r=this.hasListeners(),s=!r&&a(e,t),u=r&&h(e,n,t,i);(s||u)&&(R=(0,o.Kw)(e.options.networkMode)?"fetching":"paused",y||(E="loading")),"isRestoring"===t._optimisticResults&&(R="idle")}if(t.keepPreviousData&&!b.dataUpdatedAt&&null!=v&&v.isSuccess&&"error"!==E)r=v.data,y=v.dataUpdatedAt,E=v.status,S=!0;else if(t.select&&void 0!==b.data){if(u&&b.data===(null==l?void 0:l.data)&&t.select===this.selectFn)r=this.selectResult;else try{this.selectFn=t.select,r=t.select(b.data),r=(0,s.oE)(null==u?void 0:u.data,r,t),this.selectResult=r,this.selectError=null}catch(e){this.selectError=e}}else r=b.data;if(void 0!==t.placeholderData&&void 0===r&&"loading"===E){let e;if(null!=u&&u.isPlaceholderData&&t.placeholderData===(null==c?void 0:c.placeholderData))e=u.data;else if(e="function"==typeof t.placeholderData?t.placeholderData():t.placeholderData,t.select&&void 0!==e)try{e=t.select(e),this.selectError=null}catch(e){this.selectError=e}void 0!==e&&(E="success",r=(0,s.oE)(null==u?void 0:u.data,e,t),O=!0)}this.selectError&&(m=this.selectError,r=this.selectResult,g=Date.now(),E="error");let w="fetching"===R,Q="loading"===E,C="error"===E,I={status:E,fetchStatus:R,isLoading:Q,isSuccess:"success"===E,isError:C,isInitialLoading:Q&&w,data:r,dataUpdatedAt:y,error:m,errorUpdatedAt:g,failureCount:b.fetchFailureCount,failureReason:b.fetchFailureReason,errorUpdateCount:b.errorUpdateCount,isFetched:b.dataUpdateCount>0||b.errorUpdateCount>0,isFetchedAfterMount:b.dataUpdateCount>p.dataUpdateCount||b.errorUpdateCount>p.errorUpdateCount,isFetching:w,isRefetching:w&&!Q,isLoadingError:C&&0===b.dataUpdatedAt,isPaused:"paused"===R,isPlaceholderData:O,isPreviousData:S,isRefetchError:C&&0!==b.dataUpdatedAt,isStale:d(e,t),refetch:this.refetch,remove:this.remove};return I}updateResult(e){let t=this.currentResult,r=this.createResult(this.currentQuery,this.options);if(this.currentResultState=this.currentQuery.state,this.currentResultOptions=this.options,(0,s.VS)(r,t))return;this.currentResult=r;let n={cache:!0};(null==e?void 0:e.listeners)!==!1&&(()=>{if(!t)return!0;let{notifyOnChangeProps:e}=this.options;if("all"===e||!e&&!this.trackedProps.size)return!0;let r=new Set(null!=e?e:this.trackedProps);return this.options.useErrorBoundary&&r.add("error"),Object.keys(this.currentResult).some(e=>{let s=this.currentResult[e]!==t[e];return s&&r.has(e)})})()&&(n.listeners=!0),this.notify({...n,...e})}updateQuery(){let e=this.client.getQueryCache().build(this.client,this.options);if(e===this.currentQuery)return;let t=this.currentQuery;this.currentQuery=e,this.currentQueryInitialState=e.state,this.previousQueryResult=this.currentResult,this.hasListeners()&&(null==t||t.removeObserver(this),e.addObserver(this))}onQueryUpdate(e){let t={};"success"===e.type?t.onSuccess=!e.manual:"error"!==e.type||(0,o.DV)(e.error)||(t.onError=!0),this.updateResult(t),this.hasListeners()&&this.updateTimers()}notify(e){n.V.batch(()=>{var t,r,s,n,i,u,o,l;e.onSuccess?(null==(t=(r=this.options).onSuccess)||t.call(r,this.currentResult.data),null==(s=(n=this.options).onSettled)||s.call(n,this.currentResult.data,null)):e.onError&&(null==(i=(u=this.options).onError)||i.call(u,this.currentResult.error),null==(o=(l=this.options).onSettled)||o.call(l,void 0,this.currentResult.error)),e.listeners&&this.listeners.forEach(e=>{e(this.currentResult)}),e.cache&&this.client.getQueryCache().notify({query:this.currentQuery,type:"observerResultsUpdated"})})}}function a(e,t){return!1!==t.enabled&&!e.state.dataUpdatedAt&&!("error"===e.state.status&&!1===t.retryOnMount)||e.state.dataUpdatedAt>0&&c(e,t,t.refetchOnMount)}function c(e,t,r){if(!1!==t.enabled){let s="function"==typeof r?r(e):r;return"always"===s||!1!==s&&d(e,t)}return!1}function h(e,t,r,s){return!1!==r.enabled&&(e!==t||!1===s.enabled)&&(!r.suspense||"error"!==e.state.status)&&d(e,r)}function d(e,t){return e.isStaleByTime(t.staleTime)}},1513:function(e,t,r){"use strict";let s;r.d(t,{_:function(){return u}});var n=r(959);let i=n.createContext((s=!1,{clearReset:()=>{s=!1},reset:()=>{s=!0},isReset:()=>s})),u=()=>n.useContext(i)},784:function(e,t,r){"use strict";r.d(t,{pf:function(){return n},KJ:function(){return u},JN:function(){return i}});var s=r(959);let n=(e,t)=>{(e.suspense||e.useErrorBoundary)&&!t.isReset()&&(e.retryOnMount=!1)},i=e=>{s.useEffect(()=>{e.clearReset()},[e])},u=({result:e,errorResetBoundary:t,useErrorBoundary:r,query:s})=>{var n;return e.isError&&!t.isReset()&&!e.isFetching&&(n=[e.error,s],"function"==typeof r?r(...n):!!r)}},1792:function(e,t,r){"use strict";r.d(t,{S:function(){return i}});var s=r(959);let n=s.createContext(!1),i=()=>s.useContext(n);n.Provider},1866:function(e,t,r){"use strict";r.d(t,{Fb:function(){return s},SB:function(){return i},Z$:function(){return n},j8:function(){return u}});let s=e=>{e.suspense&&"number"!=typeof e.staleTime&&(e.staleTime=1e3)},n=(e,t)=>e.isLoading&&e.isFetching&&!t,i=(e,t,r)=>(null==e?void 0:e.suspense)&&n(t,r),u=(e,t,r)=>t.fetchOptimistic(e).then(({data:t})=>{null==e.onSuccess||e.onSuccess(t),null==e.onSettled||e.onSettled(t,null)}).catch(t=>{r.clearReset(),null==e.onError||e.onError(t),null==e.onSettled||e.onSettled(void 0,t)})},8861:function(e,t,r){"use strict";r.d(t,{h:function(){return v}});var s=r(959),n=r(8646),i=r(2043),u=r(8650),o=r(9168),l=r(1453);class a extends l.l{constructor(e,t){super(),this.client=e,this.queries=[],this.result=[],this.observers=[],this.observersMap={},t&&this.setQueries(t)}onSubscribe(){1===this.listeners.length&&this.observers.forEach(e=>{e.subscribe(t=>{this.onUpdate(e,t)})})}onUnsubscribe(){this.listeners.length||this.destroy()}destroy(){this.listeners=[],this.observers.forEach(e=>{e.destroy()})}setQueries(e,t){this.queries=e,u.V.batch(()=>{let e=this.observers,r=this.findMatchingObservers(this.queries);r.forEach(e=>e.observer.setOptions(e.defaultedQueryOptions,t));let s=r.map(e=>e.observer),n=Object.fromEntries(s.map(e=>[e.options.queryHash,e])),u=s.map(e=>e.getCurrentResult()),o=s.some((t,r)=>t!==e[r]);(e.length!==s.length||o)&&(this.observers=s,this.observersMap=n,this.result=u,this.hasListeners()&&((0,i.e5)(e,s).forEach(e=>{e.destroy()}),(0,i.e5)(s,e).forEach(e=>{e.subscribe(t=>{this.onUpdate(e,t)})}),this.notify()))})}getCurrentResult(){return this.result}getQueries(){return this.observers.map(e=>e.getCurrentQuery())}getObservers(){return this.observers}getOptimisticResult(e){return this.findMatchingObservers(e).map(e=>e.observer.getOptimisticResult(e.defaultedQueryOptions))}findMatchingObservers(e){let t=this.observers,r=new Map(t.map(e=>[e.options.queryHash,e])),s=e.map(e=>this.client.defaultQueryOptions(e)),n=s.flatMap(e=>{let t=r.get(e.queryHash);return null!=t?[{defaultedQueryOptions:e,observer:t}]:[]}),i=new Set(n.map(e=>e.defaultedQueryOptions.queryHash)),u=s.filter(e=>!i.has(e.queryHash)),l=new Set(n.map(e=>e.observer)),a=t.filter(e=>!l.has(e)),c=e=>{let t=this.client.defaultQueryOptions(e),r=this.observersMap[t.queryHash];return null!=r?r:new o.z(this.client,t)},h=u.map((e,t)=>{if(e.keepPreviousData){let r=a[t];if(void 0!==r)return{defaultedQueryOptions:e,observer:r}}return{defaultedQueryOptions:e,observer:c(e)}}),d=(e,t)=>s.indexOf(e.defaultedQueryOptions)-s.indexOf(t.defaultedQueryOptions);return n.concat(h).sort(d)}onUpdate(e,t){let r=this.observers.indexOf(e);-1!==r&&(this.result=(0,i.Rc)(this.result,r,t),this.notify())}notify(){u.V.batch(()=>{this.listeners.forEach(e=>{e(this.result)})})}}var c=r(8924),h=r(1792),d=r(1513),f=r(784),p=r(1866);function v({queries:e,context:t}){let r=(0,c.NL)({context:t}),i=(0,h.S)(),o=s.useMemo(()=>e.map(e=>{let t=r.defaultQueryOptions(e);return t._optimisticResults=i?"isRestoring":"optimistic",t}),[e,r,i]),[l]=s.useState(()=>new a(r,o)),v=l.getOptimisticResult(o);(0,n.$)(s.useCallback(e=>i?()=>void 0:l.subscribe(u.V.batchCalls(e)),[l,i]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),s.useEffect(()=>{l.setQueries(o,{listeners:!1})},[o,l]);let b=(0,d._)();o.forEach(e=>{(0,f.pf)(e,b),(0,p.Fb)(e)}),(0,f.JN)(b);let y=v.some((e,t)=>(0,p.SB)(o[t],e,i)),m=y?v.flatMap((e,t)=>{let r=o[t],s=l.getObservers()[t];if(r&&s){if((0,p.SB)(r,e,i))return(0,p.j8)(r,s,b);(0,p.Z$)(e,i)&&(0,p.j8)(r,s,b)}return[]}):[];if(m.length>0)throw Promise.all(m);let g=v.find((e,t)=>{var r,s;return(0,f.KJ)({result:e,errorResetBoundary:b,useErrorBoundary:null!=(r=null==(s=o[t])?void 0:s.useErrorBoundary)&&r,query:l.getQueries()[t]})});if(null!=g&&g.error)throw g.error;return v}},5312:function(e,t,r){"use strict";r.d(t,{a:function(){return f}});var s=r(2043),n=r(9168),i=r(959),u=r(8646),o=r(8650),l=r(1513),a=r(8924),c=r(1792),h=r(784),d=r(1866);function f(e,t,r){let f=(0,s._v)(e,t,r);return function(e,t){let r=(0,a.NL)({context:e.context}),s=(0,c.S)(),n=(0,l._)(),f=r.defaultQueryOptions(e);f._optimisticResults=s?"isRestoring":"optimistic",f.onError&&(f.onError=o.V.batchCalls(f.onError)),f.onSuccess&&(f.onSuccess=o.V.batchCalls(f.onSuccess)),f.onSettled&&(f.onSettled=o.V.batchCalls(f.onSettled)),(0,d.Fb)(f),(0,h.pf)(f,n),(0,h.JN)(n);let[p]=i.useState(()=>new t(r,f)),v=p.getOptimisticResult(f);if((0,u.$)(i.useCallback(e=>s?()=>void 0:p.subscribe(o.V.batchCalls(e)),[p,s]),()=>p.getCurrentResult(),()=>p.getCurrentResult()),i.useEffect(()=>{p.setOptions(f,{listeners:!1})},[f,p]),(0,d.SB)(f,v,s))throw(0,d.j8)(f,p,n);if((0,h.KJ)({result:v,errorResetBoundary:n,useErrorBoundary:f.useErrorBoundary,query:p.getCurrentQuery()}))throw v.error;return f.notifyOnChangeProps?v:p.trackResult(v)}(f,n.z)}},8646:function(e,t,r){"use strict";r.d(t,{$:function(){return n}});var s=r(4322);let n=s.useSyncExternalStore},6834:function(e,t,r){"use strict";r.d(t,{Dv:function(){return a},KO:function(){return h},b9:function(){return c}});var s=r(959),n=r(4477);let i=(0,s.createContext)(void 0),u=e=>{let t=(0,s.useContext)(i);return(null==e?void 0:e.store)||t||(0,n.K7)()},o=e=>e instanceof Promise,l=s.use||(e=>{if("pending"===e.status)throw e;if("fulfilled"===e.status)return e.value;if("rejected"===e.status)throw e.reason;throw e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t}),e});function a(e,t){let r=u(t),[[n,i,a],c]=(0,s.useReducer)(t=>{let s=r.get(e);return Object.is(t[0],s)&&t[1]===r&&t[2]===e?t:[s,r,e]},void 0,()=>[r.get(e),r,e]),h=n;(i!==r||a!==e)&&(c(),h=r.get(e));let d=null==t?void 0:t.delay;return(0,s.useEffect)(()=>{let t=r.sub(e,()=>{if("number"==typeof d){setTimeout(c,d);return}c()});return c(),t},[r,e,d]),(0,s.useDebugValue)(h),o(h)?l(h):h}function c(e,t){let r=u(t),n=(0,s.useCallback)((...t)=>{if(!("write"in e))throw Error("not writable atom");return r.set(e,...t)},[r,e]);return n}function h(e,t){return[a(e,t),c(e,t)]}},4477:function(e,t,r){"use strict";let s;r.d(t,{K7:function(){return m},cn:function(){return i}});let n=0;function i(e,t){let r=`atom${++n}`,s={toString:()=>r};return"function"==typeof e?s.read=e:(s.init=e,s.read=e=>e(s),s.write=(e,t,r)=>t(s,"function"==typeof r?r(e(s)):r)),t&&(s.write=t),s}let u=e=>"init"in e,o=e=>!!e.write,l=new WeakMap,a=(e,t)=>{l.set(e,t),e.catch(()=>{}).finally(()=>l.delete(e))},c=(e,t)=>{let r=l.get(e);r&&(l.delete(e),r(t))},h=(e,t)=>{e.status="fulfilled",e.value=t},d=(e,t)=>{e.status="rejected",e.reason=t},f=(e,t)=>"v"in e&&"v"in t&&Object.is(e.v,t.v),p=(e,t)=>"e"in e&&"e"in t&&Object.is(e.e,t.e),v=e=>"v"in e&&e.v instanceof Promise,b=e=>{if("e"in e)throw e.e;return e.v},y=()=>{let e,t,r;let s=new WeakMap,n=new WeakMap,i=new Map;e=new Set,t=new Set,r=new Set;let l=e=>s.get(e),y=(e,t)=>{Object.freeze(t);let r=s.get(e);if(s.set(e,t),i.has(e)||i.set(e,r),r&&v(r)){let e="v"in t?t.v instanceof Promise?t.v:Promise.resolve(t.v):Promise.reject(t.e);c(r.v,e)}},m=(e,t,r)=>{let s=new Map,n=!1;r.forEach(r=>{let i=r===e?t:l(r);i?(s.set(r,i),t.d.get(r)!==i&&(n=!0)):console.warn("[Bug] atom state not found")}),(n||t.d.size!==s.size)&&(t.d=s)},g=(e,t,r)=>{let s=l(e),n={d:(null==s?void 0:s.d)||new Map,v:t};return(r&&m(e,n,r),s&&f(s,n)&&s.d===n.d)?s:(y(e,n),n)},R=(e,t,r)=>{let s=l(e),n={d:(null==s?void 0:s.d)||new Map,e:t};return(r&&m(e,n,r),s&&p(s,n)&&s.d===n.d)?s:(y(e,n),n)},E=e=>{let t,r;let s=l(e);if(s&&(s.d.forEach((t,r)=>{r===e||n.has(r)||E(r)}),Array.from(s.d).every(([t,r])=>t===e||l(t)===r)))return s;let i=new Set,c=!0,f=t=>{if(i.add(t),t===e){let e=l(t);if(e)return b(e);if(u(t))return t.init;throw Error("no atom init")}let r=E(t);return b(r)},p={get signal(){return t||(t=new AbortController),t.signal},get setSelf(){return o(e)||console.warn("setSelf function cannot be used with read-only atom"),!r&&o(e)&&(r=(...t)=>{if(c&&console.warn("setSelf function cannot be called in sync"),!c)return M(e,...t)}),r}};try{let r=e.read(f,p);if(r instanceof Promise){let s;let n=new Promise((t,u)=>{let o=!1;r.then(r=>{o||(o=!0,g(e,n,i),h(n,r),t(r))},t=>{o||(o=!0,g(e,n,i),d(n,t),u(t))}),s=e=>{o||(o=!0,e.then(e=>h(n,e),e=>d(n,e)),t(e))}});return n.status="pending",a(n,e=>{e&&s(e),null==t||t.abort()}),g(e,n,i)}return g(e,r,i)}catch(t){return R(e,t,i)}finally{c=!1}},S=e=>b(E(e)),O=e=>{let t=n.get(e);return t||(t=T(e)),t},w=(e,t)=>!t.l.size&&(!t.t.size||1===t.t.size&&t.t.has(e)),Q=e=>{let t=n.get(e);t&&w(e,t)&&x(e)},C=e=>{let t=n.get(e);null==t||t.t.forEach(t=>{if(t!==e){let e=l(t),r=E(t);e&&f(e,r)||C(t)}})},I=(e,...t)=>{let r=!0,s=e=>b(E(e)),n=(t,...s)=>{let n;if(t===e){if(!u(t))throw Error("atom not writable");let e=l(t),r=g(t,s[0]);e&&f(e,r)||C(t)}else n=I(t,...s);return r||j(),n},i=e.write(s,n,...t);return r=!1,i},M=(e,...t)=>{let r=I(e,...t);return j(),r},T=(e,t)=>{let s={t:new Set(t&&[t]),l:new Set};if(n.set(e,s),r.add(e),E(e).d.forEach((t,r)=>{let s=n.get(r);s?s.t.add(e):r!==e&&T(r,e)}),E(e),o(e)&&e.onMount){let t=e.onMount((...t)=>M(e,...t));t&&(s.u=t)}return s},x=e=>{var t;let s=null==(t=n.get(e))?void 0:t.u;s&&s(),n.delete(e),r.delete(e);let i=l(e);i?(v(i)&&c(i.v),i.d.forEach((t,r)=>{if(r!==e){let t=n.get(r);t&&(t.t.delete(e),w(r,t)&&x(r))}})):console.warn("[Bug] could not find atom state to unmount",e)},_=(e,t,r)=>{let s=new Set(t.d.keys());null==r||r.forEach((t,r)=>{if(s.has(r)){s.delete(r);return}let i=n.get(r);i&&(i.t.delete(e),w(r,i)&&x(r))}),s.forEach(t=>{let r=n.get(t);r?r.t.add(e):n.has(e)&&T(t,e)})},j=()=>{for(;i.size;){let e=Array.from(i);i.clear(),e.forEach(([e,t])=>{let r=l(e);if(r){r.d!==(null==t?void 0:t.d)&&_(e,r,null==t?void 0:t.d);let s=n.get(e);s&&!(t&&!v(t)&&(f(t,r)||p(t,r)))&&s.l.forEach(e=>e())}else console.warn("[Bug] no atom state to flush")})}e.forEach(e=>e()),t.forEach(e=>e("state"))},k=(e,r)=>{let s=O(e);j();let n=s.l;return n.add(r),t.forEach(e=>e("sub")),()=>{n.delete(r),Q(e),t.forEach(e=>e("unsub"))}};return{get:S,set:M,sub:k,dev_subscribe_state:t=>(console.warn("[DEPRECATED] dev_subscribe_state is deprecated and will be removed in the next minor version. use dev_subscribe_store instead."),e.add(t),()=>{e.delete(t)}),dev_subscribe_store:e=>(t.add(e),()=>{t.delete(e)}),dev_get_mounted_atoms:()=>r.values(),dev_get_atom_state:e=>s.get(e),dev_get_mounted:e=>n.get(e),dev_restore_atoms:e=>{for(let[t,r]of e)u(t)&&(g(t,r),C(t));j()}}},m=()=>(s||(s=y()),s)}}]);